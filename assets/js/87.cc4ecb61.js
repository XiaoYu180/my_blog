(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{655:function(t,s,a){"use strict";a.r(s);var e=a(29),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[t._v("#")]),t._v(" 背景")]),t._v(" "),a("ul",[a("li",[t._v("pytest 运行 测试用例生成 allure 报告时，当测试用例名称修改后重新运行，会保留历史运行记录")]),t._v(" "),a("li",[t._v("又或者分开运行两个测试用例文件，但是 allure 报告生成目录是同一个，那么 allure 报告会同时显示两个文件的测试用例运行情况")]),t._v(" "),a("li",[t._v("咱们来看看这种情况")])]),t._v(" "),a("h3",{attrs:{id:"目录结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[t._v("#")]),t._v(" 目录结构")]),t._v(" "),a("p",[t._v("下面两个栗子都是这个目录结构")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1896874/202010/1896874-20201028110652149-1920030839.png",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"指定测试用例文件名称的栗子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#指定测试用例文件名称的栗子"}},[t._v("#")]),t._v(" 指定测试用例文件名称的栗子")]),t._v(" "),a("h4",{attrs:{id:"test-1-py-的代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#test-1-py-的代码"}},[t._v("#")]),t._v(" test_1.py 的代码")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test_1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test_1 文件的测试用例1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test_2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test_1 文件的测试用例2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("h4",{attrs:{id:"运行命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行命令"}},[t._v("#")]),t._v(" 运行命令")]),t._v(" "),a("p",[t._v("进入该目录下，cmd 运行")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("pytest test_1.py --alluredir"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("./allure\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h4",{attrs:{id:"allure-报告"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#allure-报告"}},[t._v("#")]),t._v(" allure 报告")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1896874/202010/1896874-20201028111346609-886062831.png",alt:""}})]),t._v(" "),a("p",[t._v("只有两条用例")]),t._v(" "),a("h4",{attrs:{id:"修改后的-test-1-py-的代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改后的-test-1-py-的代码"}},[t._v("#")]),t._v(" 修改后的 test_1.py 的代码")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test_11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test_1 文件的测试用例1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test_22")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test_1 文件的测试用例2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("h4",{attrs:{id:"再次运行命令-查看-allure-报告"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#再次运行命令-查看-allure-报告"}},[t._v("#")]),t._v(" 再次运行命令，查看 allure 报告")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1896874/202010/1896874-20201028111355331-1963122828.png",alt:""}})]),t._v(" "),a("p",[t._v("四条用例，包含了历史的两条，这不是我们希望看到的")]),t._v(" "),a("h3",{attrs:{id:"分开运行测试用例文件的栗子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分开运行测试用例文件的栗子"}},[t._v("#")]),t._v(" 分开运行测试用例文件的栗子")]),t._v(" "),a("h4",{attrs:{id:"test-2-py-的代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#test-2-py-的代码"}},[t._v("#")]),t._v(" test_2.py 的代码")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test_1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test_1 文件的测试用例1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test_2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test_1 文件的测试用例2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("h4",{attrs:{id:"分开运行-test-1-和-test-2-两个测试用例文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分开运行-test-1-和-test-2-两个测试用例文件"}},[t._v("#")]),t._v(" 分开运行 test_1 和 test_2 两个测试用例文件")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 先运行第一个")]),t._v("\npytest test_1.py --alluredir"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("./allure\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 再运行第二个，此时应该希望 allure 报告只有 test_2.py 的测试用例")]),t._v("\npytest test_2.py --alluredir"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("./allure\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("h4",{attrs:{id:"查看-allure-报告"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看-allure-报告"}},[t._v("#")]),t._v(" 查看 allure 报告")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1896874/202010/1896874-20201028112004419-420743254.png",alt:""}})]),t._v(" "),a("p",[t._v("出现了 test_1.py 的测试用例，这不是想要的结果")]),t._v(" "),a("h2",{attrs:{id:"clean-alluredir-参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clean-alluredir-参数"}},[t._v("#")]),t._v(" --clean-alluredir 参数")]),t._v(" "),a("h4",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),a("ul",[a("li",[t._v("pytest 提供了 --clean-alluredir 参数可以清空 allure 报告生成的目录")]),t._v(" "),a("li",[t._v("可以看看 pytest 的说明文档")])]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("pytest -h\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1896874/202010/1896874-20201028112503115-1419060590.png",alt:""}})]),t._v(" "),a("h4",{attrs:{id:"将上面的栗子重新运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将上面的栗子重新运行"}},[t._v("#")]),t._v(" 将上面的栗子重新运行")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 先运行第一个")]),t._v("\npytest test_1.py --alluredir"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("./allure\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 再运行第二个，此时应该希望 allure 报告只有 test_2.py 的测试用例")]),t._v("\npytest test_2.py --alluredir"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("./allure --clean-alluredir\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("h4",{attrs:{id:"运行结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行结果"}},[t._v("#")]),t._v(" 运行结果")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img2020.cnblogs.com/blog/1896874/202010/1896874-20201028113553241-1279045150.png",alt:""}})]),t._v(" "),a("p",[t._v("本文转自 "),a("a",{attrs:{href:"https://www.cnblogs.com/poloyy/p/13890086.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.cnblogs.com/poloyy/p/13890086.html"),a("OutboundLink")],1),t._v("，如有侵权，请联系删除。")])])}),[],!1,null,null,null);s.default=n.exports}}]);